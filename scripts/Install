#!/bin/bash

REPO_DIR="$HOME/TermHub"       # diretório do repositório
APP_DIR="$REPO_DIR/TermHubApp"
IMG_DIR="$REPO_DIR/images"
JAR_FILE="$APP_DIR/TermHub.jar"
ICON_FILE="$IMG_DIR/TermHub.png"
DESKTOP_DIR="$HOME/.local/share/applications"
LAUNCHER="$DESKTOP_DIR/TermHub.desktop"

if [ "$1" = "install" ] && [ "$2" = "termhub" ]; then
    echo "Instalando TermHub..."

    if [ ! -f "$JAR_FILE" ]; then
        echo "Erro: TermHub.jar não encontrado em $APP_DIR"
        exit 1
    fi

    mkdir -p "$HOME/.local/share/TermHub"
    cp "$JAR_FILE" "$HOME/.local/share/TermHub/TermHub.jar"

    echo "TermHub instalado em ~/.local/share/TermHub/"
    
    # Perguntar por atalho
    read -p "Criar atalho na área de trabalho? (s/n): " RES
    if [ "$RES" = "s" ] || [ "$RES" = "S" ]; then
        mkdir -p "$DESKTOP_DIR"
        echo "[Desktop Entry]
Type=Application
Name=TermHub
Exec=termux-open --launch-app 'sh -c \"java -jar $HOME/.local/share/TermHub/TermHub.jar\"'
Icon=$ICON_FILE
Terminal=false
Categories=Utility;" > "$LAUNCHER"

        echo "Atalho criado em $LAUNCHER"
    fi

    exit 0
fi

echo "Uso:
  termhub install termhub
"
