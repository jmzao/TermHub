#!/data/data/com.termux/files/usr/bin/bash

# Diretório padrão dos apps
APP_ROOT="$HOME/termpak-apps"
mkdir -p "$APP_ROOT"

APP="$1"

if [ -z "$APP" ]; then
    echo "Uso:"
    echo "  install <app>"
    echo ""
    echo "Apps disponíveis:"
    echo "  termhub"
    exit 1
fi

case "$APP" in

    termhub)
        echo "Instalando TermHub..."

        HUB_DIR="$APP_ROOT/TermHub"
        mkdir -p "$HUB_DIR"

        BASE_URL="https://raw.githubusercontent.com/jmzao/TermHub/main"

        JAR_URL="$BASE_URL/TermHubApp/TermHub.jar"
        IMG_URL="$BASE_URL/images/TermHub.png"

        echo "Baixando TermHub.jar..."
        wget -q "$JAR_URL" -O "$HUB_DIR/TermHub.jar" || {
            echo "Erro ao baixar TermHub.jar"
            exit 1
        }

        echo "Baixando imagem TermHub.png..."
        wget -q "$IMG_URL" -O "$HUB_DIR/TermHub.png" || {
            echo "Erro ao baixar imagem PNG"
            exit 1
        }

        echo "TermHub instalado com sucesso!"

        # Criar comando automático 'termbhub'
        echo "Criando comando termbhub..."
        echo "#!/data/data/com.termux/files/usr/bin/bash
java -jar $HUB_DIR/TermHub.jar" > "$PREFIX/bin/termbhub"
        chmod +x "$PREFIX/bin/termbhub"

        echo "Comando criado! Rode: termbhub"
        ;;

    *)
        echo "Erro: app desconhecido!"
        echo "Apps suportados:"
        echo "  termhub"
        exit 1
        ;;
esac
